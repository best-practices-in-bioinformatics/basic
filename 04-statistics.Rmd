# 统计及可视化 {#statistics}

数据分析过程中，检查要用到各种各样的统计学原理。甚至某个原理本身单独都可以讲解一本书。

## 基本统计概念

### 第一节 描述性统计量

什么是统计学问题呢？通常为了解决一类问题，我们会观察一组和该问题相关的样本，利用总体中的这部分样本来推断总体的情况进而得到结论。在通过样本推断总体之前，我们首先需用对已有样本数据进行简单的评估和描述，针对这一需求也就引出了**描述统计量**这一概念。进行描述性统计时，我们最关注的数据两个层面的问题，分别是数据的集中趋势和变异分散性。

#### 数据的集中趋势 {-}

面对少则几十个多则上千个数字，第一步通常是观察平均水平。这里介绍三个计算数据平均水平的概念。分别是均值(mean)、中位数(median)和众数(mode)。

**均值**：所有观察值的和除以观察的个数。通常，算数平均是最自然和常用的测度，其问题在于对异常值(outliers)非常敏感。有极端值存在时，均值不能代表样本的绝大多数情况。

**中位数**：所谓中位数，是指所有样本观测值由小到大排序，位于中间的一个（样本数为奇数）或者两个数据的平均值（样本数为偶数）。

通常，当数据分布对称时，中位数近似等于算数平均数；当数据正倾斜时（画出的图像向右边倾斜），中位数小于算数平均数；当数据负倾斜时（画出的图像向左倾斜），中位数大于算数平均数。因此在很多情况下，我们可以通过比较样本的均值和中位数对数据的分布对称性进行一个初判断。

**众数**：在样本的所有观测值中，出现频率最大（出现次数最多）的数值称为众数。这里需要说明的是，当数据量很大而且数值不会多次重复出现时众数并不能给我带来太多的信息。比如当你计算上万个基因的表达量后，得到众数最可能的是0，因为每个基因的表达值或多或少都有一些不同，这时候出现最多的就是那些没有检测的表达基因的0了。

但是在遇到类别数据而非数值型数据时，众数有很大用处，或者说众数是唯一可以用于类别数据的平均数。

在R中，上述提到的均值和中位数可以通过`mean(data)`和`median(data)`函数进行计算,而中位数可以通过`modeest`包的`mfv(data)`函数得到。


#### 数据的变异性（离散性） {-}

平均数显然不能说明一切问题，因为在说明样本数据时我们还必须考虑数据是不是过于分散。例如在篮球队员的投篮平均得分相同的情况下，更重要的时知道他们哪些人发挥得更加稳定。

**极差(range)**指的是一个样本中最大值和最小值之间的差值。在统计学中也称为全距，它能够指出数据的“宽度”（范围）。但是，它和均值一样非常容易受到极端值得影响，而且会受到样本量的明显影响。

针对极差的缺点，统计学中又引入了**分位数(quantiles)**的概念，通俗讲就是把数据的“宽度”细分后再去进行比较从而更好地描述数据的分布形态。分位数用三个点将从小到大排列好的数据分为四个相等部分，而这三个点也就是我们常说的四分位数，分别叫做下四分位数，中位数和上四分位数。当然，除了四分位你也可以计算十分位或者百分位。

分位数的引进能够说明数值的位置，但是无法说明某个数值在该位置出现的概率。为了说明数据的稳定程度，我们可以考虑计算每个数据值到平均数的距离（此处，你可以脑补一个高瘦形的数据曲线和矮胖形的数据曲线），但是样本中所有观测值和均值的偏差和永远是0。为了解决这种正负距离相互抵消的问题，统计学中又引入了**方差(variance)**和**标准差(standard deviation)**的概念。

所谓**方差**是指数值与均值距离平方数的平均数，而**标准差**则是方差的平方根。标准差体现了数据的变异度，标准差越小，数值和均值越近。通常，均值用μ表示，而标准差用σ表示。

在R中，可以通过`quantile()`计算分位数，通过`var()`来计算方差，通过`sd()`来计算标准差。

有个**标准差**的概念，随之而来的问题是当两个样本标准差相同但是均值相差很大时该如何做出区分。统计学中随之引入了**变异系数(coefficient of variation, CV)**的概念，变异系数是指样本标准差除以均值再乘100%。变异系数不会受数据尺度的影响，因此常用来进行不同样本之间变异性的比较。

在实际的数据分析中，如果要比较不同数据集(均值和标准差都不同)之间的数值，通常会引入**z score**的概念，z score 的计算方法是用某一数值减去均值在除以标准差。通过对原始数据进行z变换，我们将不同数据集转化为一个新的均值为0，标准差为1的分布。

#### 计算描述性统计量 {-}

在R中，使用`summary()`函数方便的得到一个data frame 的各种描述性统计量。当某一列是数值型变量时，你可以得到该列数据的均值、极值、方差和分位数。

```{r iris}
summary(iris) 

#查看常用的描述统计量
```

#### 形象化展示 {-}

所谓形象化展示就是用图示的方法来展示数据结果，比较常见的方法有条形图，箱线图，直方图等。

下面我们使用R中内置的数据**Edgar Anderson's Iris Data**进行一些简单展示。


```{r}
boxplot(iris$Sepal.Length)

# 使用箱线图展示某一列数据的分布情况

```

```{r}
hist(iris$Sepal.Length)

# 使用直方图展示某一列数据的分布情况

```


```{r}
plot(ecdf(iris$Sepal.Length))

# 绘制简单的累积分布函数图展示某一列数据分布情况

```

### 第二节 

### 统计分布

正态分布
指数分步
γ(伽玛)分布
weibull分布
F分布
T分布
β(贝塔)分布
χ²(卡方)分布
均匀分布

介绍这些分布跟NGS组学的关联

## 常用统计方法

### 差异分析

### 生存分析

### 主成分分析

### 进化树

## 常用可视化工具

### 网页工具

### 本地软件

> IGV等

### R语言基础绘图系

### R语言ggplot2绘图系统

## 可视化举例

### 表达矩阵可视化大全

把rmd文件发在这里即可，[表达矩阵可视化](http://bio-info-trainee.com/tmp/basic_visualization_for_expression_matrix.html)

### 热图

### 火山图

### 染色体结构图

### reads覆盖图

### 其它





